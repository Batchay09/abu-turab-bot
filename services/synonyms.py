"""
Islamic terminology synonyms for query expansion.
Helps find similar questions even when different terms are used.
"""

# Synonym dictionary: term -> list of alternatives
ISLAMIC_SYNONYMS = {
    # Pillars of Islam - Столпы ислама
    "намаз": ["салят", "молитва", "салат", "намазы"],
    "салят": ["намаз", "молитва", "салат"],
    "молитва": ["намаз", "салят"],

    "закят": ["закат", "обязательное садакъа", "очистительная милостыня", "закят аль-маль"],
    "закат": ["закят", "обязательное садакъа"],

    "пост": ["саум", "ураза", "сыям", "говеть"],
    "саум": ["пост", "ураза", "сыям"],
    "ураза": ["пост", "саум", "сыям"],
    "рамадан": ["рамазан", "месяц поста"],
    "рамазан": ["рамадан"],

    "хадж": ["паломничество", "большое паломничество"],
    "умра": ["малое паломничество", "умрах"],

    # Purification - Очищение
    "тахарат": ["очищение", "тахара", "ритуальная чистота"],
    "тахара": ["тахарат", "очищение"],
    "вуду": ["омовение", "малое омовение", "вуду"],
    "омовение": ["вуду", "тахарат"],
    "гусль": ["полное омовение", "большое омовение", "купание"],
    "таяммум": ["сухое омовение", "очищение песком"],
    "наджаса": ["нечистота", "скверна"],

    # Prayer terms - Термины намаза
    "фаджр": ["утренний намаз", "утренняя молитва", "субх"],
    "зухр": ["полуденный намаз", "обеденный намаз", "зухр намаз"],
    "аср": ["послеполуденный намаз", "аср намаз", "предвечерний"],
    "магриб": ["вечерний намаз", "закатный намаз", "магриб намаз"],
    "иша": ["ночной намаз", "иша намаз"],
    "джума": ["пятничный намаз", "пятничная молитва", "джума намаз"],
    "джамаат": ["коллективная молитва", "джамаат намаз", "совместная молитва"],
    "суннат": ["сунна", "сунна намаз", "дополнительная молитва"],
    "нафиль": ["добровольная молитва", "нафль"],
    "витр": ["витр намаз", "нечетная молитва"],
    "тахаджуд": ["ночная молитва", "тахаджуд намаз", "ночное поклонение"],
    "кыям": ["стояние в молитве"],
    "руку": ["поясной поклон"],
    "саджда": ["земной поклон", "суджуд", "саджа"],
    "суджуд": ["саджда", "земной поклон"],
    "ташаххуд": ["сидение в молитве", "ат-тахият"],

    # Belief - Вероубеждение
    "акыда": ["вероубеждение", "акида", "убеждения"],
    "таухид": ["единобожие", "монотеизм"],
    "ширк": ["многобожие", "придание сотоварищей"],
    "куфр": ["неверие", "куфр"],
    "иман": ["вера", "имаан"],
    "такфир": ["обвинение в неверии"],

    # Family - Семья
    "никах": ["брак", "женитьба", "исламский брак", "никях"],
    "никях": ["никах", "брак"],
    "талак": ["развод", "талякъ"],
    "талякъ": ["талак", "развод"],
    "махр": ["приданое", "свадебный дар", "калым"],
    "идда": ["период ожидания", "идда после развода"],
    "валима": ["свадебное угощение", "свадьба"],
    "хула": ["развод по инициативе жены"],
    "нафака": ["содержание", "алименты"],

    # Food - Еда
    "халяль": ["дозволенное", "халял", "разрешённое"],
    "харам": ["запретное", "запрещённое"],
    "макрух": ["нежелательное", "порицаемое"],
    "мубах": ["дозволенное", "разрешённое"],
    "забиха": ["забой животного", "заклание", "халяльный забой"],

    # Financial - Финансы
    "риба": ["ростовщичество", "процент", "лихва"],
    "садака": ["милостыня", "садакъа", "пожертвование"],
    "садакъа": ["садака", "милостыня"],
    "садакату ль-фитр": ["закят аль-фитр", "фитр садака"],
    "закят аль-фитр": ["садакату ль-фитр", "фитр"],
    "вакф": ["эндаумент", "пожертвование имущества"],

    # Death - Смерть и похороны
    "джаназа": ["похороны", "джаназа намаз", "погребальная молитва"],
    "кафан": ["саван", "погребальная одежда"],
    "дафн": ["погребение", "захоронение"],
    "кабр": ["могила"],

    # Other terms
    "дуа": ["мольба", "дуа", "молитва-просьба", "ду'а"],
    "зикр": ["поминание Аллаха", "зикр"],
    "хадис": ["хадис", "хадисы", "сунна пророка"],
    "сунна": ["сунна пророка", "путь пророка"],
    "фикх": ["исламское право", "юриспруденция"],
    "фатва": ["фетва", "религиозное решение", "фатвы"],
    "шариат": ["исламский закон", "шариа"],
    "мазхаб": ["школа права", "мазхаб", "мазхабы"],
    "джихад": ["усердие", "борьба на пути Аллаха"],
    "хиджаб": ["покрывало", "платок", "хиджаб"],
    "никаб": ["никаб", "никъаб"],
    "аура": ["аурат", "части тела для сокрытия"],
    "истихара": ["истихара намаз", "молитва для выбора"],
    "тауба": ["покаяние", "раскаяние"],
    "каффара": ["искупление", "кафара"],
    "истихфар": ["истигфар", "просьба о прощении", "астагфируллах"],
    "истигфар": ["истихфар", "просьба о прощении", "астагфируллах"],
}


def expand_query(query: str) -> list[str]:
    """
    Expand query with synonyms for better search recall.

    Args:
        query: Original search query

    Returns:
        List of query variations including synonyms
    """
    expanded = [query]
    query_lower = query.lower()

    for term, synonyms in ISLAMIC_SYNONYMS.items():
        if term in query_lower:
            for synonym in synonyms:
                # Replace term with synonym
                expanded_query = query_lower.replace(term, synonym)
                if expanded_query not in expanded:
                    expanded.append(expanded_query)

    return expanded


def get_related_terms(term: str) -> list[str]:
    """
    Get related terms for a given term.

    Args:
        term: Islamic term

    Returns:
        List of related/synonym terms
    """
    term_lower = term.lower()

    # Direct lookup
    if term_lower in ISLAMIC_SYNONYMS:
        return ISLAMIC_SYNONYMS[term_lower]

    # Reverse lookup - find term in synonym lists
    for key, synonyms in ISLAMIC_SYNONYMS.items():
        if term_lower in [s.lower() for s in synonyms]:
            return [key] + [s for s in synonyms if s.lower() != term_lower]

    return []
